<!DOCTYPE html>
<meta charset="utf-8">
<style>

.link {
  stroke: #ccc;
  stroke-width:1px;
}

.link:hover{
	stroke-width:3px;
}

.node text {
  pointer-events: none;
  font: 9px sans-serif;
}

div.tooltip {	
    position: absolute;			
    text-align: left;			
    width: 100px;					
    height: auto;					
    padding: 2px;				
    font: 10px sans-serif;		
    background: lightgrey;	
    border: 0.1px;		
    border-radius: 8px;			
    pointer-events: none;			
}

</style>
<body>
<script src="//d3js.org/d3.v4.0.0-alpha.49.min.js"></script>
<script>

var width = 1200,
    height = 700

var div = d3.select("body").append("div")	
    .attr("class", "tooltip")				
    .style("opacity", 0);

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height);
	
	

d3.json("constructs_updated.json", function(error, json) {
  if (error) throw error;


  var link = svg.selectAll(".link")
      .data(json.links)
    .enter().append("line")	
    .attr("class","link")
 	.on("mouseover", function(d) {		
              div.transition()		
                  .duration(200)		
                  .style("opacity", 1);		
              div	.html(d.conn)	
                  .style("left", (d3.event.pageX) + "px")		
                  .style("top", (d3.event.pageY - 28) + "px");	
              })					
          .on("mouseout", function(d) {		
              div.transition()		
                  .duration(500)		
                  .style("opacity", 0);	
          });
		
		  var scX = 0.9;
		  var scY = 1.05;		
		
		
	link.attr("x1", function(d) { return json.nodes[d.source].x*scX; })
        .attr("y1", function(d) { return json.nodes[d.source].y*scY; })
        .attr("x2", function(d) { return json.nodes[d.target].x*scX; })
        .attr("y2", function(d) { return json.nodes[d.target].y*scY; })
		

  var node = svg.selectAll(".node")
      .data(json.nodes)
    .enter().append("g")
	.attr("class", "node")
	.attr("transform", function(d){
		return "translate(" + d.x*scX + "," + d.y*scY + ")"});		
	//.attr("transform", "translate(" + function(d){return d.x;} + "," + function(d){return d.y;} + ")");
	
	//.attr("x", function(d){ console.log(d); return d.x;})
	//.attr("y",function(d){return d.y;});

  node.append("circle")
      .attr("x", -8)
      .attr("y", -8)
      .attr("r", function(d){return 4*d.group;})
	  .attr("fill","steelblue")
 	.on("mouseover", function(d) {
		d3.select(this).attr("fill","orange");		
              div.transition()		
                  .duration(200)		
                  .style("opacity", 1);		
              div	.html(d.def)	
                  .style("left", (d3.event.pageX) + "px")		
                  .style("top", (d3.event.pageY - 28) + "px");	
              })					
          .on("mouseout", function(d) {	
			d3.select(this).attr("fill","steelblue");		
              div.transition()		
                  .duration(500)		
                  .style("opacity", 0);	
          });

  node.append("text")
      .attr("dx", 12)
      .attr("dy", ".35em")
      .text(function(d) { return d.name });
	    

  /*simulation.on("tick", function() {
    link.attr("x1", function(d) { return d.source.x; })
        .attr("y1", function(d) { return d.source.y; })
        .attr("x2", function(d) { return d.target.x; })
        .attr("y2", function(d) { return d.target.y; });
		
  });*/
});

</script>
